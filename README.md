# schoolCapstone1
3학년2학기 캡스톤

# 웹웹.

처음 계획
우선 처음 캡스톤 주제로 움직이는 공기 청정기로 정하게 되었고
기능의 큰 틀은 청청기가 방안을 돌아 다니면서 레이타 센서로 방의 구조를 파악하고 방 구조를 처음에 정의를 해두면 해당 방에 대해 미세먼지, 온도, 습도에 대한 데이터를 보내 주어
웹에서 데이터들을 사용자가 보기 쉽게 가공하여 보여주기 위해 필요한 기능 별로 아래 설명을 해두었 습니다.

웹 기능/구조
1. 로그인 기능 : 로그인이 되어 있지 않은 상태 에서만 보여준다
![1](https://user-images.githubusercontent.com/93322852/190896120-c04489e6-d536-4f10-8f77-eb22fddb63f9.png)
  -DB에서 일치 하는 아이디외 비밀번호가 존재 하면 성공
  
2. 로그아웃 기능 : 로그인이 되어 있는 경우 에만 버튼 활성화
![2](https://user-images.githubusercontent.com/93322852/190896208-3ade92da-2bb5-4b89-b07b-ed65bf986be7.png)
  -로그인 성공시 닉네임이 관리자인 경우 alert창으로 성공 메세지 후 홈 화면으로 이동 한다
 ![image](https://user-images.githubusercontent.com/93322852/190896254-0bb6904b-71b9-4c04-852e-5f9e2d1a5300.png)
  -성공시 메인화면의 산단 메뉴바에 로그아웃, 방만들기, 데이터 정보에 대한 버튼 추가
  
3. 회원가입 기능 : 로그인이 되어 있지 않은 상황에만 버튼 활성화
![image](https://user-images.githubusercontent.com/93322852/190896293-ebcffba4-0ffe-4124-af86-2baccc680f0f.png)
  -회원가입의 경우 name, loginId, email에 대해서는 기존에 DB에 이미 존재 하는 정보라면 alert창으로 오류 메세지로 중복에 대한 메세지를 보여주고 다시 회원가입 페이지로 이동
  -마찬가지로 비밀번호의 경우도 비밀번호, 확인요 비밀번호가 일치 하는지 확인후 모든 조건이 만족하면 alert창으로 성공 메세지 후  메인 화면으로 이동
  
4. 홈으로 가는 버튼 : 홈으로 가는 버튼을 누르면 홈 화면으로 이동
  -버튼 클릭시 홈 화면으로 이동한다
  
5. 방만들기 : 로그인이 되어 있는 상태에서 방을 추가 하면 DB에 저장 -> 방을 초반에 만들어 사용할 예정이므로 추후 방을 추가 하는 작업을 하지 않기 때문에 필요 앖는 기능
![5](https://user-images.githubusercontent.com/93322852/190896430-e2de08ef-ebd6-4371-a2b8-fefe3d372315.png)
  -기존에 존재하는 방이름과 동일 하지 않는 방 이름이라면 성공 후 홈 화면 으로 이동
  -아래에 기존 방이름이 어떤것 들이 있는지 보여주나다
  
  어려웠던 점 : 방을 만드는 기능을 만들때 해당 방이 이미 존재 하는지 정보를 DB에서 불러 올때 방에 처음 쿼리문으로 방 정보를 불러올때 해당방에 대해 하나의 정보만 있으면 오류가   나지 않았지만 한 방에 대해 여러 데이터기 존재할 경우 쿼리문에서 여러개의 데이터에 대해 처리를 하지 못해 오류가 났었는데 처음에는 문제를 잘 인식하지 못 해 해결하는데 어려움이   있었다. 해결 방법으로는 join된 테이블 에는 해당 방에 대한 데이터가 여러개 있을경우 방이름도 여러개가 생성 되었기에 문제가 발생 하였고 해결하기 위해서 정보를 불러오는 것에서   room테이블을 불러오는 것으로 수정을 하여 해결 하였다.
  
6. 종합적 데이터 정보 리스트 : 화면의 데이터 정보 버튼을 누르면 해당 방에 대한 데이터의 평균치로 리스트를 보여준다
![6](https://user-images.githubusercontent.com/93322852/190896461-5fa459ff-b6cb-40f9-a781-d298c29dacd3.png)
  -우선 방에 해당 하는 여러 데이터들을 평균치로 계산하여 평균 데이터 정보로 모든 방에 대한 정보를 보여준다
  -방이름을 클릭하면 해당 방에 대한 정보들만 나오는 디테일 화면으로 이동
  -우측 상단 삭제, 수정 아이콘으로 기능 추가
  
  어려웠던 점 : 데이터를 보여줄때는 join된 테이블에서 불러온 데이터를 보여주는 것 이었는데 그러다 보니 방 한개에 대해 여러 데이터가 존재 할 경우 해당 방에 대한 이름괴 데이터가   일대일 관계로 평균치로 나오는 것 으로 수정하는데 있어 어려움이 많았다.
  이를 해결 하기 위해 jstl기능으로 jsp에서 join된 값을 받아 계산을 처리한 후 if문으로 조건을 만족하는 데이터만 화면에 보여주게 함으로써 문제를 해결하였다.
  
7. 해당 방에 대한 데이터만  : 해당 방 이름을 클릭하면 해당 방에 대한 데이터들을 시간, 일로 나타낸다
![7](https://user-images.githubusercontent.com/93322852/190896823-82c899f6-515c-4865-b919-a7dcc0377e33.png)
  -해당 방에 대한 데이터들을 시간 별로 모두 보여준다.
8. 삭제 : 해당 방에 대해 삭제 아이콘을 누르면 삭제 된다.
  -데이터 리스트 버튼을 클릭하며 우측 삭제 아이콘을 누르면 alert창으로 삭제 완료 메세지를 보여 주고 데이커 리스트 화면으로 이동한다
  
9. 수정 : 해당 방에 대해 수정 아이콘을 클릭 하면 수정 화면으로 이동후 수정 한다(만약 기존의 방 이름으로 수정을 시도 하면 alert창으로 경고)
![8](https://user-images.githubusercontent.com/93322852/190896895-a9dae8da-bcf7-4b08-8a88-783a6b9a0551.png)
  -데이터 리스트 에서 우측 수정 아이콘을 클릭 하면 수정 화면으로 이동하여 수정 하는 방 이름이 기존에 존재한는 방 이름과 중복이 되지 않는다면 alert로 성공 메세지를 알려주고
  기존의 방이름과 중복이 된다면 alert로 경고 메세지를 보여주고 데이터 리스트 화면으로 이동 한다.
  
10. 페이징 기능 : 데테일한 정보를 보기 위해 해당 방에 대한 모든 온도, 습도, 미세먼지에 대한 정보들을 한페이지에 6개씩 보여주는 기능
  ![paging](https://user-images.githubusercontent.com/93322852/193008842-5e9ba6a9-e4e0-455c-88d2-fe74441bdf75.png)
  어려웠던 점 : 스프링 에서 제공하는 pageable API를 사용하면 페이징 기능을 간단하게 구현할 수 있지만 그러기 위해서는 JPA형식으로 코드를 짰어야 했는데 그렇지 않아서 해당 api를 사   용하기 위해서는 구조의 큰 틀을 변경해야 하기 때문에 다른 방법을 찾은데 구글링 하는 시간이 많이 걸렸다. 
  다행히 dto로 기능을 만들어 페이지 기능을 직접 만들어 주어 DB에 있는 데이터 총 갯수외 시작 페이지만 설정해주어 각각 버튼을 눌렀을때 화면에 뿌려지는 데이터에 limit 시작숫자, 한번   에 보여지는 숫자로 DB에서 데이터를 불러와 a태그를 통해 해당 페이지로 이동하는 형태로 기능을 마무리 했다.
  
11. 검색 기능 : 온도, 미세먼지, 습도에 대해 원하는 값을 검색하면 해당 값들만 보여 준다
  ![search](https://user-images.githubusercontent.com/93322852/193009496-62d1470a-c795-403a-a2b9-711b5401ba6e.png)
  어려웠던 점 : 검색 기능의 경우 어떤 방법으로 리스트에서 검색된 내용만 보여지게 할지 구글링을 하다 방법이 너무 많아 이것저것 시도하면서 시간이 많이 들어갔던것 같고 sql문에서       LIKE%%로 해당 검색 문자를 보내와 받아온 값으로 화면에 뿌려주려고 했는데 계속 알 수 없는 오류가 떠서 구글링 결과 jdbcType=VARCHAR를 넣어 주어야 한다는 것을 알게 되었다. null 값   이 들어올 수도 있기 때문에 미리 기본값을 넣어주어야 오류를 피할 수 있다.

  

  
  
  ==문제 상황==
  현재 DB에서 room테이블의 infoId와 + info테이블의 roomId를 통해 조인을 시키는데 방을 만들때 infoId에 null값이 들어가게 되어 추후 방에 대한 정보와 매칭이 될 수 없다.
  따라서 현재 테이블의 infoId값을 autoincrement를 해주어야 하는데 이를 위해서는 primarykey를 걸어주어야 하는데 한테이블에 두개 거는 법을 구글링 해서 걸어주고 infoId역시 걸어   주어 수정 해주기
  
  
  ==참고 싸이트== 
  https://wsss.tistory.com/(웹 디자인에 대한 코드 참고)
  https://nerdcave.com/tailwind-cheat-sheet(테일윈드를 사용하면서 기능들을 검색할때 사용)
  https://noonnu.cc/(폰트 디자인을 참고할때 사용)
  https://getbootstrap.com/docs/5.2/getting-started/introduction/(CSS디자인 틀을 참고할때 사용)
  https://icons.getbootstrap.com/(아이콘 디자인을 참고할때 사용)
  
  
  ==웹 에서 서버로 부터 필요한 기능들 정리==
![10](https://user-images.githubusercontent.com/93322852/193010267-b80268f0-1e7b-45a6-a061-ea0dfd98ac2b.png)

![10](https://user-images.githubusercontent.com/93322852/193010278-45ecf3f1-bef9-46c7-a876-e299d1299533.png)

![10](https://user-images.githubusercontent.com/93322852/193010298-ce5f9807-28d4-409b-bd65-1598590742c6.png)

![10](https://user-images.githubusercontent.com/93322852/193010366-9de853e9-4cef-4a03-aaca-56836aa55ee0.png)

![10](https://user-images.githubusercontent.com/93322852/193010368-985bb5f4-8303-4dc4-89e8-edaaf85d85cc.png)

![10](https://user-images.githubusercontent.com/93322852/193010378-7c97a12b-3287-47a1-916d-59d232cb19cb.png)

![10](https://user-images.githubusercontent.com/93322852/193010390-ad47b769-94e1-47e7-a9f2-31c10230b896.png)

![10](https://user-images.githubusercontent.com/93322852/193010407-d47b11db-ab27-4b9b-be3f-6809a04fa239.png)

